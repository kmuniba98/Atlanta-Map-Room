<!DOCTYPE html>
<html>

<head>
  <meta charset=utf-8 />
  <title>Projector</title>
  <script src='https://api.mapbox.com/mapbox-gl-js/v0.46.0/mapbox-gl.js'></script>
  <script src="/socket.io/socket.io.js"></script>
  <link href='https://api.mapbox.com/mapbox-gl-js/v0.46.0/mapbox-gl.css' rel='stylesheet' />
  <style>
    body { margin:0; padding:0; }
    #map { position:absolute; top:0; bottom:0; width:75%;}
  </style>
</head>

<body style="background-color:black">
  <style>
      @import url('https://fonts.googleapis.com/css?family=PT+Mono|PT+Serif');

        h6 {
            font-family: 'PT Mono', monospace;
            padding-left: 80%;
            line-height: 25px;
            font-size: 20px;
            padding-bottom: 17px;
        }

        h5 {
            font-family: 'PT Serif', serif;;
            padding-left: 80%;
            line-height: 20px;
            font-size: 24px;
            color: white;
        }
        span {
          padding-top: 0px;
          padding-bottom: 0px;
          margin-bottom: 0px;
          margin-top: 0px;
          line-height: 10px;
          color: red;
        }
  </style>

  <div id='map' style="background-color:black"></div>
  <div id="point_text" style="max-height:100%;color:white;background-color:black">
    <h5 id=ID_>ID</h5>
    <h6 id=ID>ID</h6><span></span>
    <h5 id=Latitude_>Latitude</h5>
    <h6 id=Latitude>Latitude</h6><span></span>
    <h5 id=Longitude_>Longitude</h5>
    <h6 id=Longitude>Longitude</h6><span></span>
    <h5 id=ParcelID_>ParcelID</h5>
    <h6 id=ParcelID>ParcelID</h6><span></span>
    <h5 id=Address_>Address</h5>
    <h6 id=Address>Address</h6><span></span>
    <h5 id=AssessChange_>AssessChange</h5>
    <h6 id=AssessChange>AssessChange</h6><span></span>
    <h5 id=ApprChange_>ApprChange</h5>
    <h6 id=ApprChange>ApprChange</h6><span></span>
    <h5 id=OBJECTID_17_>OBJECTID_17</h5>
    <h6 id=OBJECTID_17>OBJECTID_17</h6><span></span>
    <h5 id=TaxYear_>TaxYear</h5>
    <h6 id=TaxYear>TaxYear</h6><span></span>
    <h5 id=Address_17_>Address_17</h5>
    <h6 id=Address_17>Address_17</h6><span></span>
    <h5 id=AddrNumber_>AddrNumber</h5>
    <h6 id=AddrNumber>AddrNumber</h6><span></span>
    <h5 id=AddrPreDir_>AddrPreDir</h5>
    <h6 id=AddrPreDir>AddrPreDir</h6><span></span>
    <h5 id=AddrStreet_>AddrStreet</h5>
    <h6 id=AddrStreet>AddrStreet</h6><span></span>
    <h5 id=AddrSuffix_>AddrSuffix</h5>
    <h6 id=AddrSuffix>AddrSuffix</h6><span></span>
    <h5 id=AddrPosDir_>AddrPosDir</h5>
    <h6 id=AddrPosDir>AddrPosDir</h6><span></span>
    <h5 id=AddrUntTyp_>AddrUntTyp</h5>
    <h6 id=AddrUntTyp>AddrUntTyp</h6><span></span>
    <h5 id=AddrUnit_>AddrUnit</h5>
    <h6 id=AddrUnit>AddrUnit</h6><span></span>
    <h5 id=Owner_>Owner</h5>
    <h6 id=Owner>Owner</h6><span></span>
    <h5 id=OwnerAddr1_>OwnerAddr1</h5>
    <h6 id=OwnerAddr1>OwnerAddr1</h6><span></span>
    <h5 id=OwnerAddr2_>OwnerAddr2</h5>
    <h6 id=OwnerAddr2>OwnerAddr2</h6><span></span>
    <h5 id=TaxDist_>TaxDist</h5>
    <h6 id=TaxDist>TaxDist</h6><span></span>
    <h5 id=TotAssess_>TotAssess</h5>
    <h6 id=TotAssess>TotAssess</h6><span></span>
    <h5 id=LandAssess_>LandAssess</h5>
    <h6 id=LandAssess>LandAssess</h6><span></span>
    <h5 id=ImprAssess_>ImprAssess</h5>
    <h6 id=ImprAssess>ImprAssess</h6><span></span>
    <h5 id=TotAppr_>TotAppr</h5>
    <h6 id=TotAppr>TotAppr</h6><span></span>
    <h5 id=LandAppr_>LandAppr</h5>
    <h6 id=LandAppr>LandAppr</h6><span></span>
    <h5 id=ImprAppr_>ImprAppr</h5>
    <h6 id=ImprAppr>ImprAppr</h6><span></span>
    <h5 id=LUCode_>LUCode</h5>
    <h6 id=LUCode>LUCode</h6><span></span>
    <h5 id=ClassCode_>ClassCode</h5>
    <h6 id=ClassCode>ClassCode</h6><span></span>
    <h5 id=ExCode_>ExCode</h5>
    <h6 id=ExCode>ExCode</h6><span></span>
    <h5 id=LivUnits_>LivUnits</h5>
    <h6 id=LivUnits>LivUnits</h6><span></span>
    <h5 id=LandAcres_>LandAcres</h5>
    <h6 id=LandAcres>LandAcres</h6><span></span>
    <h5 id=NbrHood_>NbrHood</h5>
    <h6 id=NbrHood>NbrHood</h6><span></span>
    <h5 id=Subdiv_>Subdiv</h5>
    <h6 id=Subdiv>Subdiv</h6><span></span>
    <h5 id=SubdivNum_>SubdivNum</h5>
    <h6 id=SubdivNum>SubdivNum</h6><span></span>
    <h5 id=SubdivLot_>SubdivLot</h5>
    <h6 id=SubdivLot>SubdivLot</h6><span></span>
    <h5 id=SubdivBlck_>SubdivBlck</h5>
    <h6 id=SubdivBlck>SubdivBlck</h6><span></span>
    <h5 id=FeatureID_>FeatureID</h5>
    <h6 id=FeatureID>FeatureID</h6><span></span>
    <h5 id=SHAPESTArea_>SHAPESTArea</h5>
    <h6 id=SHAPESTArea>SHAPESTArea</h6><span></span>
    <h5 id=SHAPESTLength_>SHAPESTLength</h5>
    <h6 id=SHAPESTLength>SHAPESTLength</h6><span></span>
    <h5 id=OBJECTID_10_>OBJECTID_10</h5>
    <h6 id=OBJECTID_10>OBJECTID_10</h6><span></span>
    <h5 id=DIGEST_>DIGEST</h5>
    <h6 id=DIGEST>DIGEST</h6><span></span>
    <h5 id=SITUS_>SITUS</h5>
    <h6 id=SITUS>SITUS</h6><span></span>
    <h5 id=TAXPIN_>TAXPIN</h5>
    <h6 id=TAXPIN>TAXPIN</h6><span></span>
    <h5 id=ATRPIN_>ATRPIN</h5>
    <h6 id=ATRPIN>ATRPIN</h6><span></span>
    <h5 id=TAX_DISTR_>TAX_DISTR</h5>
    <h6 id=TAX_DISTR>TAX_DISTR</h6><span></span>
    <h5 id=OWNER1_>OWNER1</h5>
    <h6 id=OWNER1>OWNER1</h6><span></span>
    <h5 id=OWNER2_>OWNER2</h5>
    <h6 id=OWNER2>OWNER2</h6><span></span>
    <h5 id=ADD2_>ADD2</h5>
    <h6 id=ADD2>ADD2</h6><span></span>
    <h5 id=ADD3_>ADD3</h5>
    <h6 id=ADD3>ADD3</h6><span></span>
    <h5 id=ADD4_>ADD4</h5>
    <h6 id=ADD4>ADD4</h6><span></span>
    <h5 id=ADD5_>ADD5</h5>
    <h6 id=ADD5>ADD5</h6><span></span>
    <h5 id=LUC_>LUC</h5>
    <h6 id=LUC>LUC</h6><span></span>
    <h5 id=NBHD_>NBHD</h5>
    <h6 id=NBHD>NBHD</h6><span></span>
    <h5 id=PROP_CLASS_>PROP_CLASS</h5>
    <h6 id=PROP_CLASS>PROP_CLASS</h6><span></span>
    <h5 id=CLASS_>CLASS</h5>
    <h6 id=CLASS>CLASS</h6><span></span>
    <h5 id=TOT_APPR_>TOT_APPR</h5>
    <h6 id=TOT_APPR>TOT_APPR</h6><span></span>
    <h5 id=TOT_ASSESS_>TOT_ASSESS</h5>
    <h6 id=TOT_ASSESS>TOT_ASSESS</h6><span></span>
    <h5 id=IMPR_APPR_>IMPR_APPR</h5>
    <h6 id=IMPR_APPR>IMPR_APPR</h6><span></span>
    <h5 id=LAND_APPR_>LAND_APPR</h5>
    <h6 id=LAND_APPR>LAND_APPR</h6><span></span>
    <h5 id=FUL_EX_COD_>FUL_EX_COD</h5>
    <h6 id=FUL_EX_COD>FUL_EX_COD</h6><span></span>
    <h5 id=VAL_ACRES_>VAL_ACRES</h5>
    <h6 id=VAL_ACRES>VAL_ACRES</h6><span></span>
    <h5 id=STRUCT_FLR_>STRUCT_FLR</h5>
    <h6 id=STRUCT_FLR>STRUCT_FLR</h6><span></span>
    <h5 id=STRUCT_YR_>STRUCT_YR</h5>
    <h6 id=STRUCT_YR>STRUCT_YR</h6><span></span>
    <h5 id=TIEBACK_>TIEBACK</h5>
    <h6 id=TIEBACK>TIEBACK</h6><span></span>
    <h5 id=TAXYEAR_>TAXYEAR</h5>
    <h6 id=TAXYEAR>TAXYEAR</h6><span></span>
    <h5 id=STATUS_COD_>STATUS_COD</h5>
    <h6 id=STATUS_COD>STATUS_COD</h6><span></span>
    <h5 id=LIV_UNITS_>LIV_UNITS</h5>
    <h6 id=LIV_UNITS>LIV_UNITS</h6><span></span>
    <h5 id=PCODE_>PCODE</h5>
    <h6 id=PCODE>PCODE</h6><span></span>
    <h5 id=UNIT_NUM_>UNIT_NUM</h5>
    <h6 id=UNIT_NUM>UNIT_NUM</h6><span></span>
    <h5 id=GID_>GID</h5>
    <h6 id=GID>GID</h6><span></span>
    <h5 id=EXTVER_>EXTVER</h5>
    <h6 id=EXTVER>EXTVER</h6><span></span>
    <h5 id=ShapeSTArea_>ShapeSTArea</h5>
    <h6 id=ShapeSTArea>ShapeSTArea</h6><span></span>
    <h5 id=ShapeSTLength_>ShapeSTLength</h5>
    <h6 id=ShapeSTLength>ShapeSTLength</h6><span></span>
  </div>
  <script>

  var leftLong, rightLong, lowerLat, upperLat
  var curBearing = 0
  var curZoom = 1
  var curCenter = [1,1]
  var curGeoCoords, curActiveRectangle, curEndCenters
  var leftCenter = {lng:-84.3880,lat:33.7490}
  var rightCenter = {lng:-82.3880,lat:33.7490}
  var rc, lc
  var TA = false;
  var currentPoints = null;
  var socket = io('http://128.61.121.12:8080');
  var projRatio = 0.5

  mapboxgl.accessToken = 'pk.eyJ1IjoibW9kZXJubG92ZWxhY2UiLCJhIjoiY2pmY24zNzhmM2VmaTJ4cDRlNmVoa24wdCJ9.7GBTZc76YFp947kU7A14Gg';

  socket.on('pushMapUpdate', function(data) {
    console.log("Controller changed, updating map...");

    curCenter = data['center'];
    curZoom = data['zoom'];
    curBearing = data['bearing'];
    curGeoCoords = data['geoCoordinates'];
    curActiveRectangle = data['activeRectangle'];
    curEndCenters = data['endCenters']

    leftCenter = curEndCenters.lc
    rightCenter = curEndCenters.rc

    projLat = leftCenter.lat + (projRatio * (rightCenter.lat - leftCenter.lat))
    projLong = leftCenter.lng + (projRatio * (rightCenter.lng - leftCenter.lng))

    console.log(curBearing + ", " + JSON.stringify(leftCenter) + ", " + JSON.stringify(rightCenter))

    map.easeTo({center: {lng: projLong, lat:projLat}, zoom:(curZoom + 2.7), bearing:curBearing, duration:1000})
      
    
    if (TA){
        currentPoints = map.queryRenderedFeatures({'layers':['Tax Assessment']});
        console.log(currentPoints);
        socket.emit("updateTable", map.queryRenderedFeatures({'layers':['Tax Assessment']}));
        console.log("length of query"); console.log(map.queryRenderedFeatures({'layers':['Tax Assessment']}));
    }
  });

  socket.on('pushSensorUpdate', function(data) {

    var start = 1770 //1840
    var end = 5080

    projRatio = ((data.distance - start) / (end-start))

    projLat = leftCenter.lat + (projRatio * (rightCenter.lat - leftCenter.lat))
    projLong = leftCenter.lng + (projRatio * (rightCenter.lng - leftCenter.lng))

    map.easeTo({center: {lng: projLong, lat:projLat}, zoom:(curZoom + 2.7), bearing:curBearing, duration:1000})

  });

  socket.on('pushHideLayer', function(data){
    var hiddenLayer = data['clickedLayer'];
    map.setLayoutProperty(hiddenLayer, 'visibility', 'none');
  });

  socket.on('pushShowLayer', function(data){
    var shownLayer = data['clickedLayer'];
    map.setLayoutProperty(shownLayer, 'visibility', 'visible');
  });
  socket.on('pushChangeSize', function(data){ // for toggleRectangle

  });

  socket.on('addTA', function(data){
    map.setLayoutProperty('Tax Assessment', 'visibility', 'visible');
    TA = true;
  });

  socket.on('removeTA', function(data){
    console.log("in removeTA");
    map.setLayoutProperty('Tax Assessment', 'visibility', 'none');
    TA = false;
  });

  socket.on("removeMarker", function(data){
//map.queryRenderedFeatures({'layers':['Tax Assessment']})[parseInt(data['removeMarker'])].properties.ID;
    var filter = ['match', ['get', 'id'], -1, true, false];
    map.setFilter("place-highlight", filter);
  });

  socket.on("newMarker", function(data){
    var current = data.newMarker;
    console.log(current);
    console.log(current[0]);
    var pt = currentPoints[parseInt(data['index'])].properties.id;//map.queryRenderedFeatures({'layers':['Tax Assessment']})[parseInt(data['newMarker'])].properties.ID;
    console.log('adding marker');
    console.log(pt);
    var filter = ['match', ['get', 'id'], pt, true, false]
    map.setFilter("place-highlight", filter);
            
    document.getElementById("ID").innerHTML = current["0"];
    document.getElementById("Latitude").innerHTML = current["1"];
    document.getElementById("Longitude").innerHTML = current["2"];
    document.getElementById("ParcelID").innerHTML = current["3"];
    document.getElementById("Address_17").innerHTML = current["4"];
    document.getElementById("AssessChange").innerHTML = current["5"];
    document.getElementById("ApprChange").innerHTML = current["6"];
    document.getElementById("OBJECTID_17").innerHTML = current["7"];
    document.getElementById("TaxYear").innerHTML = current["8"];
    document.getElementById("Address_17").innerHTML = current["9"];
    document.getElementById("AddrNumber").innerHTML = current["10"];
    document.getElementById("AddrPreDir").innerHTML = current["11"];
    document.getElementById("AddrStreet").innerHTML = current["12"];
    document.getElementById("AddrSuffix").innerHTML = current["13"];
    document.getElementById("AddrPosDir").innerHTML = current["14"];
    document.getElementById("AddrUntTyp").innerHTML = current["15"];
    document.getElementById("AddrUnit").innerHTML = current["16"];
    document.getElementById("Owner").innerHTML = current["17"];
    document.getElementById("OwnerAddr1").innerHTML = current["18"];
    document.getElementById("OwnerAddr2").innerHTML = current["19"];
    document.getElementById("TaxDist").innerHTML = current["20"];
    document.getElementById("TotAssess").innerHTML = current["21"];
    document.getElementById("LandAssess").innerHTML = current["22"];
    document.getElementById("ImprAssess").innerHTML = current["23"];
    document.getElementById("TotAppr").innerHTML = current["24"];
    document.getElementById("LandAppr").innerHTML = current["25"];
    document.getElementById("ImprAppr").innerHTML = current["26"];
    document.getElementById("LUCode").innerHTML = current["27"];
    document.getElementById("ClassCode").innerHTML = current["28"];
    document.getElementById("ExCode").innerHTML = current["29"];
    document.getElementById("LivUnits").innerHTML = current["30"];
    document.getElementById("LandAcres").innerHTML = current["31"];
    document.getElementById("NbrHood").innerHTML = current["32"];
    document.getElementById("Subdiv").innerHTML = current["33"];
    document.getElementById("SubdivNum").innerHTML = current["34"];
    document.getElementById("SubdivLot").innerHTML = current["35"];
    document.getElementById("SubdivBlck").innerHTML = current["36"];
    document.getElementById("FeatureID").innerHTML = current["37"];
    document.getElementById("SHAPESTArea").innerHTML = current["38"];
    document.getElementById("SHAPESTLength").innerHTML = current["39"];
    document.getElementById("OBJECTID_10").innerHTML = current["40"];
    document.getElementById("DIGEST").innerHTML = current["41"];
    document.getElementById("SITUS").innerHTML = current["42"];
    document.getElementById("TAXPIN").innerHTML = current["43"];
    document.getElementById("ATRPIN").innerHTML = current["44"];
    document.getElementById("TAX_DISTR").innerHTML = current["45"];
    document.getElementById("OWNER1").innerHTML = current["46"];
    document.getElementById("OWNER2").innerHTML = current["47"];
    document.getElementById("ADD2").innerHTML = current["48"];
    document.getElementById("ADD3").innerHTML = current["49"];
    document.getElementById("ADD4").innerHTML = current["50"];
    document.getElementById("ADD5").innerHTML = current["51"];
    document.getElementById("LUC").innerHTML = current["52"];
    document.getElementById("NBHD").innerHTML = current["53"];
    document.getElementById("PROP_CLASS").innerHTML = current["54"];
    document.getElementById("CLASS").innerHTML = current["55"];
    document.getElementById("TOT_APPR").innerHTML = current["56"];
    document.getElementById("TOT_ASSESS").innerHTML = current["57"];
    document.getElementById("IMPR_APPR").innerHTML = current["58"];
    document.getElementById("LAND_APPR").innerHTML = current["59"];
    document.getElementById("FUL_EX_COD").innerHTML = current["60"];
    document.getElementById("VAL_ACRES").innerHTML = current["61"];
    document.getElementById("STRUCT_FLR").innerHTML = current["62"];
    document.getElementById("STRUCT_YR").innerHTML = current["63"];
    document.getElementById("TIEBACK").innerHTML = current["64"];
    document.getElementById("TAXYEAR").innerHTML = current["65"];
    document.getElementById("STATUS_COD").innerHTML = current["66"];
    document.getElementById("LIV_UNITS").innerHTML = current["67"];
    document.getElementById("PCODE").innerHTML = current["68"];
    document.getElementById("UNIT_NUM").innerHTML = current["69"];
    document.getElementById("GID").innerHTML = current["70"];
    document.getElementById("EXTVER").innerHTML = current["71"];
    document.getElementById("ShapeSTArea").innerHTML = current["72"];
    document.getElementById("ShapeSTLength").innerHTML = current["73"];
    /*document.getElementById("address").innerHTML = current.properties['SITUS'];
    document.getElementById("tenAssess").innerHTML = ("$" + current.properties['2010_assessment'].toString().replace(/(\d)(?=(\d\d\d)+(?!\d))/g, "$1,"));
    document.getElementById("sevenAssess").innerHTML = ("$" + current.properties['2017_assessment'].toString().replace(/(\d)(?=(\d\d\d)+(?!\d))/g, "$1,"));
    if (current.properties['assess_change'] < -100){
        document.getElementById("assess_change").innerHTML = "No Change"
    }else{
        document.getElementById("assess_change").innerHTML = (current.properties['assess_change'].toLocaleString() +"%");
    }
    document.getElementById("tenAppr").innerHTML = ("$" + current.properties['2010_appr'].toString().replace(/(\d)(?=(\d\d\d)+(?!\d))/g, "$1,"));
    document.getElementById("sevenAppr").innerHTML = ("$" + current.properties['2017_appr'].toString().replace(/(\d)(?=(\d\d\d)+(?!\d))/g, "$1,"));
    if (current.properties['appr_change'] < -100){
        document.getElementById("appr_change").innerHTML = "No Change"
    }else{
        document.getElementById("appr_change").innerHTML = (current.properties['appr_change'] +"%");
    }*/

  });


  var map = new mapboxgl.Map({
    container: 'map', // container id
    center: [-84.27173029708604, 33.76777287243536],
    style:'mapbox://styles/modernlovelace/cjjpqv3keic0y2rni1j6niy1k'
  });

  var deltaDistance = 3;
  var deltaDegrees = 1;

  function easing(t) {
      return t * (2 - t);
  }

  map.on('load', function() {
      map.getCanvas().focus();

      map.getCanvas().addEventListener('keydown', function(e) {
          e.preventDefault();
          if (e.which === 38) { // up
              map.panBy([0, -deltaDistance], {
                  easing: easing
              });
          } else if (e.which === 40) { // down
              map.panBy([0, deltaDistance], {
                  easing: easing
              });
          } else if (e.which === 37) { // left
              map.panBy([-deltaDistance, 0], {
                  easing: easing
              });
          } else if (e.which === 39) { // right
              map.panBy([deltaDistance, 0], {
                  easing: easing
              });
          } else if (e.which === 68) { // rotate ccw
              curBearing = curBearing - deltaDegrees
              map.easeTo({
                      bearing: map.getBearing() - deltaDegrees,
                      easing: easing
              });
          } else if (e.which === 65) { // rotate cw
              curBearing = curBearing + deltaDegrees
              map.easeTo({
                      bearing: map.getBearing() + deltaDegrees,
                      easing: easing
              });
          }
      }, true);
  });

  map.on('moveend', function (e) {
        socket.emit('projNudge', {'center': curCenter,
                                  'bearing': curBearing})
  });

  map.on('load', function () {
      // beltline layer
      map.addSource('beltline', {
          type: 'vector',
          url: 'mapbox://modernlovelace.9bd0nhcf'
      });
      map.addLayer({
          'id': 'beltline',
          'type': 'line',
          'source': 'beltline',
          'source-layer': 'Beltline_Weave-a4j3wv',
          'layout': {
              'visibility': 'visible',
              'line-join': 'round',
              'line-cap': 'round'
          },
          'paint': {
              'line-color': 'yellow green',
              'line-width': 8
          }
      });
      // Change median income later
      map.addSource('ACS', {
          type: 'vector',
          url: 'mapbox://modernlovelace.3jq6hc6x'
      });
      map.addLayer({
          'id': 'Median Income Change',
          'type': 'fill',
          'source': 'ACS',
          'source-layer': 'merged2-1ylp9s',
          'layout': {
              'visibility': 'none',
          },
          'paint': {
              'fill-outline-color': '#f7ff05',
              'fill-color': {
                property:'P_C_M_I',
                stops: [
                  [-100, '#00a4d1'],
                  [0, '#fffcd6'],
                  [100, '#e92f2f']
                ]
              },
              'fill-opacity': 0.5
          }
      });
      map.addLayer({
          'id': 'College Educated Change',
          'type': 'fill',
          'source': 'ACS',
          'source-layer': 'merged2-1ylp9s',
          'layout': {
              'visibility': 'none',
          },
          'paint': {
              'fill-outline-color': '#f7ff05',
              'fill-color': {
                property:'C_C_E_P',
                stops: [
                  [-40, '#00a4d1'],
                  [0, '#fffcd6'],
                  [40, '#e92f2f']
                ]
              },
              'fill-opacity': 0.5
          }
      });
      map.addLayer({
          'id': 'White Occupants Change',
          'type': 'fill',
          'source': 'ACS',
          'source-layer': 'merged2-1ylp9s',
          'layout': {
              'visibility': 'none',
          },
          'paint': {
              'fill-outline-color': '#f7ff05',
              'fill-color': {
                property:'C_W_P__',
                stops: [
                  [-30, '#00a4d1'],
                  [0, '#fffcd6'],
                  [30, '#e92f2f']
                ]
              },
              'fill-opacity': 0.5
          }
      });
      // tax layer
      map.addSource('Tax Assessment', {
          type: 'vector',
          url: 'mapbox://modernlovelace.6sytmmfk'
      });

      map.addLayer({
          'id': 'place-highlight',
          'type': 'circle',
          'source': 'Tax Assessment',
          'source-layer': 'allPoints07-24-d8xzn1',
          'paint': {
            'circle-color': '#FADA5E',
            'circle-radius': 20,
            'circle-opacity': .5,
          },
          'filter': ['==', 'ID', -1]
      });
      map.addLayer({
          'id': 'Tax Assessment',
          'type': 'circle',
          'source': 'Tax Assessment',
          'interactive': true,
          "layout": {
                    "text-font": "Open Sans Semibold, Arial Unicode MS Bold",
                    "text-offset": [0, 0.6],
                    "text-anchor": "top"
                  },
          'layout': {
              'visibility': 'none'
          },
          'paint': {
              'circle-radius': 4,
              'circle-color': {
                "property":'asses_change',
                "stops": [
                  [-105, '#C0C0C0'],
                  [-100, '#00a4d1'],
                  [0, '#fffcd6'],
                  [100, '#e92f2f']
                ]
              },
              'circle-opacity': 1
          },
          'source-layer': 'allPoints07-24-d8xzn1'
      });
      // MARTA Buses and Rail (all one color)
      map.addSource('MARTA', {
          type: 'vector',
          url: 'mapbox://modernlovelace.6n51t4jo'
      });
      map.addLayer({
          'id': 'MARTA',
          'type': 'line',
          'source': 'MARTA',
          'source-layer': 'marta-8pkeb3',
          'layout': {
              'visibility': 'none',
              'line-join': 'round',
              'line-cap': 'round'
          },
          'paint': {
              'line-width': 10,
              'line-color': "#32ffd9",
              'line-opacity': 0.15
          }
      });
  });
  map.boxZoom.disable();
  map.scrollZoom.disable();
  map.dragPan.disable();
  map.dragRotate.disable();
  map.keyboard.disable();
  map.doubleClickZoom.disable();
  map.touchZoomRotate.disable();

  </script>

</body>
</html>
